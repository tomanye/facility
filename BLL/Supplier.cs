
// Generated by MyGeneration Version # (1.3.0.3)

using System;
using DAL;
using System.Data;

namespace BLL
{
	public class Supplier : _Supplier
	{
		public Supplier()
		{
		
		}


		public bool LoadAll()
		{
			string query = string.Format("select *, [LineNo] = 0 from Supplier order by CompanyName");
			this.LoadFromRawSql(query);
			int i = 1;
			while (!EOF)
			{
				this.SetColumn("LineNo", i++);
				MoveNext();
			}
			return true;
		}

		public DataTable GetSupplierByName(string companyName)
		{
			this.FlushData();
			this.Where.WhereClauseReset();
			this.Where.CompanyName.Value = companyName;
			this.Query.Load();
			return this.DataTable;
		}


		public DataTable GetSuppliersWithTransaction()
		{
			this.FlushData();
			this.LoadFromRawSql(String.Format("SELECT * FROM Supplier WHERE ID IN (SELECT SupplierID FROM ReceiveDoc)"));
			return this.DataTable;
		}

		public DataTable GetActiveSuppliers()
		{
			this.Where.IsActive.Value = true;
			this.Query.Load();
			return this.DataTable;
		}
	}
}