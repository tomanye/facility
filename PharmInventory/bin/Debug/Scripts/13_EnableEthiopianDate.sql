
sp_configure 'clr enabled', 1
GO

RECONFIGURE
GO


DROP Function ToEthiopianDate
GO

DROP TYPE EthiopianDate
GO

DROP ASSEMBLY EthiopianDateCLR
GO

CREATE ASSEMBLY [EthiopianDateCLR]
AUTHORIZATION [dbo]
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300B77A584D0000000000000000E00002210B010800002400000006000000000000AE43000000200000006000000000400000200000000200000400000000000000040000000000000000A000000002000095BE0000030040850000100000100000000010000010000000000000100000000000000000000000604300004B000000006000004803000000000000000000000000000000000000008000000C000000B84200001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000B4230000002000000024000000020000000000000000000000000000200000602E7273726300000048030000006000000004000000260000000000000000000000000000400000402E72656C6F6300000C0000000080000000020000002A0000000000000000000000000000400000420000000000000000000000000000000090430000000000004800000002000500102E0000A81400000900000000000000000000000000000050200000800000000000000000000000000000000000000000000000000000000000000000000000793D267E1CF7EE75F2853AD84DD76A34CB175AFC909BD21E5792E91B0EBEFABB4531693970B16DBC06791AF9C47596068489F6AB218221E3747F23F3CDA92086FAA74B2708C5A76682D7EB19DA4750F939736DE5DCDDF581C2186FF5AE97F1C5DF79D6106FC09BD7349346DEDD1DADC16BCE54D9986273394BCCC5D96BCB5173133001000C0000000100001100027B010000040A2B00062A1330020014000000020000110073160000060A06177D01000004060B2B00072A133002003E00000003000011000F00281500000A16FE010B072D090028020000060A2B240F00FE16040000016F1600000A281700000A2828000006281800000A28050000060A2B00062A00001330040056000000040000110002280100000616FE01130611062D0A007E1900000A13052B390073170000060A02280F0000060B02280C0000060C0228090000060D120112021203282D000006001204070809281A00000A00110413052B0011052A0000133004006F000000050000110073160000060A0F00FE16050000016F1600000A178D200000010D09161F2F9D096F1C00000A0B0607169A281D00000A7D040000040607179A281D00000A7D030000040607189A281D00000A7D02000004066F06000006130411042D0C007201000070731E00000A7A060C2B00082A00133002009A000000060000110002280F000006200F270000300E02280F00000616FE0416FE012B01160B072D0500160A2B7202280C00000616310F02280C0000061F0DFE0216FE012B01160B072D0500160A2B5002280C0000061F0DFE0116FE010B072D19000228090000061CFE0216FE010B072D0500160A2B29002B2202280900000616310F0228090000061F1EFE0216FE012B01160B072D0500160A2B04170A2B00062A00001330020068000000070000110002280100000616FE010C082D090072A80000700B2B4F00731F00000A0A06027B040000046F2000000A260672B20000706F2100000A2606027B030000046F2000000A260672B20000706F2100000A2606027B020000046F2000000A26066F1600000A0B2B00072A1330020068000000070000110002280100000616FE010C082D090072A80000700B2B4F00731F00000A0A0602280B0000066F2100000A260672B60000706F2100000A260602280E0000066F2100000A260672BE0000706F2100000A2606027B020000046F2000000A26066F1600000A0B2B00072A133001000C0000000800001100027B040000040A2B00062A260002037D040000042A000013300100110000000900001100022809000006281E0000060A2B00062A000000133001000C0000000800001100027B030000040A2B00062A260002037D030000042A00001330010011000000090000110002280C000006281D0000060A2B00062A000000133001000C0000000800001100027B020000040A2B00062A260002037D020000042A000013300200290000000A0000110002280C0000061F0AFE0216FE010B072D0C0002280F00000617580A2B0902280F0000060A2B00062A00000013300200520000000A0000110002280C0000061F0A310F02280C0000061F0DFE0416FE012B01170B072D0F0002280C00000618581F0C590A2B2202280C0000061F0DFE0116FE010B072D0500180A2B0C0002280C00000618580A2B00062A000013300200230000000A0000110002280C0000061F0DFE0116FE010B072D06001F1E0A2B090228090000060A2B00062A0013300200C10000000A00001100036F090000060228090000063321036F0C00000602280C000006331302280F000006036F0F000006FE0116FE012B01170B072D0800160A3882000000036F0F00000602280F000006FE0416FE010B072D0500150A2B68036F0F00000602280F0000063313036F0C00000602280C000006FE0416FE012B01170B072D0500150A2B3D036F0F00000602280F0000063321036F0C00000602280C0000063313036F09000006022809000006FE0416FE012B01170B072D0500150A2B04170A2B00062A000000133002001C000000080000110002036F1600000A281800000A280500000628140000060A2B00062A1E02282200000A2A133003005B0000000B00001102282200000A000002282300000A0A1200282400000A7D0500000402282300000A0A1200282500000A7D0600000402282300000A0A1200282600000A7D07000004027C05000004027C06000004027C07000004282700000600002A7E02282200000A000002037D0500000402047D0600000402057D07000004002A0013300400480000000C00001102282200000A000003178D200000010B07161F2F9D076F1C00000A0A0206169A282700000A7D050000040206179A282700000A7D060000040206189A282700000A7D07000004002A133003004F0000000D000011001B8D210000010C0816027C07000004282800000AA2081772B2000070A20818027C06000004282800000AA2081972B2000070A2081A027C05000004282800000AA208282900000A0A060B2B00072ABE0002037D0500000402047D0600000402057D07000004027C05000004027C06000004027C070000042827000006002A0013300100110000000900001100027B06000004281D0000060A2B00062A00000013300200AF0000000E00001100020B071759450D000000020000000A000000120000001A000000220000002A000000320000003A000000420000004A000000520000005A000000620000002B6872C60000700A2B6472D20000700A2B5C72DC0000700A2B5472E40000700A2B4C72EE0000700A2B4472F40000700A2B3C72FE0000700A2B3472080100700A2B2C72120100700A2B24721C0100700A2B1C72220100700A2B14722C0100700A2B0C72340100700A2B04140A2B00062A00133002005F0000000E00001100020B0717594506000000020000000A000000120000001A000000220000002A0000002B30723C0100700A2B3072420100700A2B28724C0100700A2B2072540100700A2B18725C0100700A2B1072640100700A2B08726C0100700A2B00062A0013300300150000000F00001100040A0F000F011200282700000600060B2B00072A00000013300300180000000800001100031F093205031F0C3105021E592B03021D590A2B00062A13300200280000000600001100027B050000041A5D2D0E027B050000041F645D16FE012B01170B072D04170A2B04160A2B00062A13300200260000001000001100020328200000060A061A5D2D09061F645D16FE012B01170C082D04170B2B04160B2B00072A00001330040032000000080000110020EB0A0000206D0100000217595A58026C2300000000000010405B6C282A00000A69581F1E0317595A5804580A2B00062A000003300500560000000000000000031A0220EC0A0000595A20B7050000586C230000000000D496405B6C282A00000A69540402034A17172823000006596C230000000000003E405B6C282A00000A6917585405021758034A044A17282300000659542A0000133003005900000011000011000304172823000006282B00000A1D5D0A060C08450700000002000000060000000A0000000E00000012000000160000001A0000002B1C160B2B1C170B2B18180B2B14190B2B101A0B2B0C1B0B2B081C0B2B04160B2B00072A00000013300300890000000800001100206D0100000217595A0217596C2300000000000010405B6C282A00000A69580217596C2300000000000059405B6C282A00000A69590217596C2300000000000079405B6C282A00000A6958206F010000035A206A010000596C2300000000000028405B6C282A00000A695803183110020328220000062D041FFE2B01152B01165804580A2B00062A5A00024A034A044A28260000060203042824000006002A133004007900000012000011001616FE0113042B000F00282400000A0A0F00282500000A0B0F00282600000A0C06070828260000061200120112022824000006001B8D010000011305110516088C25000001A211051772B2000070A2110518078C25000001A211051972B2000070A211051A068C25000001A21105282C00000A0D2B00092A000000133002000F00000008000011001F1802581C591F185D0A2B00062A00133004001E000000130000110002027B05000004027B06000004027B0700000428250000060A2B00062A0000133004001E000000080000110002027B05000004027B06000004027B0700000428250000060A2B00062A0000133002000F00000008000011001F1802581C581F185D0A2B00062A5A00024A034A044A2823000006020304282F000006002A0000133004005B000000140000110002178D2000000113061106161F2F9D11066F1C00000A0A06169A282700000A0B06179A282700000A0C06189A282700000A0D0908072823000006120312021201282F000006001204090807282D00000A00110413052B0011052A00133005006A0000001500001100732E00000A0A030228300000065402034A17172826000006590B02034A19172826000006321006034A6F2F00000A2D03182B01172B01160C041F0C0708585A2075010000586C230000000000F076405B6C282A00000A69540502034A044A172826000006591758542A000013300300A200000016000011000217590A066C230000000088D501415B6C282A00000A690B0620B13A02005D0C086C230000000080D5E1405B6C282A00000A690D0820AC8E00005D130411046C230000000000D496405B6C282A00000A691305110420B50500005D130611066C230000000000D076405B6C282A00000A6913072090010000075A1F64095A581A11055A581107581308091A2E0B11071A2E06110817582B02110813092B0011092A000042534A4201000100000000000C00000076322E302E35303732370000000005006C000000F8070000237E0000640800007007000023537472696E677300000000D40F000078010000235553004C1100001000000023475549440000005C1100004C03000023426C6F6200000000000000020000015717A2010900000000FA253300160000010000002800000003000000070000003000000033000000020000002F0000001100000016000000010000000A0000000D000000010000000200000000000A00010000000000060056004F000A007E006900060088004F000A00C30069000A00EA006900060090024F000600D3024F000600F803E60306000F04E60306002C04E60306004B04E60306006404E60306007D04E60306009804E6030600B304E6030600EB04CC040600FF04CC0406000D05E60306002605E60306005405430506008905760557009D0500000600CC05AC050600EC05AC0506000A064F000A003B0620060A005706200606005E06CC0406007406CC040A007F0620060A00A00620060600B3064F000600B8064F000600C5064F000600D5064F000600F306E706060018074F00060025074F0006004907340706005B0734070000000001000000000001000100092010001F002D00050001000100010010003E002D00050005001700010094000A0001009C000D000100A2000D000100A9000D000600E7010D000600D5010D0006000E020D00D02000000000E609AF0010000100E820000000009608BA00140001000821000000009600CF00190001005421000000008600DB0020000200B821000000009600F400250002003422000000008600FA0010000300DC2200000000C60010012C000300502300000000860019012C000300C423000000008608260130000300DC230000000086082F0134000300E82300000000860838012C000400082400000000860846013000040020240000000086085001340004002C240000000086085A012C0005004C240000000086086A0130000500642400000000860873013400050070240000000086087C0130000600A8240000000086088B013000060008250000000086089B01300006003825000000008600AA0139000600082600000000E601AA013F0007003026000000008618B401440008003826000000008618B401440008009F26000000008618B40159000800C026000000008618B40160000B00142700000000860012022C000C006F270000000086001F0259000C00A02700000000860027022C000F00C027000000009600270265000F007C28000000009600340265001000E8280000000094003F026A0011000C290000000094004F02710014003029000000008600600210001600642900000000940060027700160098290000000096006E026A001800D8290000000096007F027D001B003C2A0000000086009A0288001F00A42A000000009600AD026A002200392B000000009600BE0290002500502B000000009600BE029A002800D82B000000009600BE02A0002900F42B000000008600DC02A5002A00202C000000008600E90230002A004C2C000000009600F902A0002A00672C000000009600F90290002B00802C000000009600F902AA002E00E82C0000000091000E037D002F00602D0000000091001F03A0003300000001003603000001003903000001003D03000001003D03000001003D03000001004303000001004303000001004703000002004C03000003005203000001005603000001005F03000002006D03000003007C0300000100D501000001005203000001005F03000002006D03000003007C03000001005F03000002006D03000001005F03000002006D0300000100890300000200970300000300A60300000100B303000002004703000003004C0300000400520300000100890300000200970300000300A603000001005F03000002006D03000003007C03000001005F03000002006D03000003007C0300000100BD0300000100CB0300000100CB03000001004703000002004C0300000300520300000100D00300000100B303000002004703000003004C0300000400520300000100B3030200090002000D004100B40160004900B40160005100B40160005900B40160006100B40160006900B40160007100B40160007900B40160008100B401B0008900B40160009100B40160009900B4016000A100B4016000A900B401B500B900B4013400C100B4014400C900B4014400D100B4015D01E100B401AA01F100B40144002100AF001000090010012C003900F400AA0029009406C0012100C101CC012100B4015900F900B40144000901BF06F0011101CD06F7011901B40160002101B4014400210101070D022101010714020900B401440039000807300239006A0130003900460130003900100730002901F400F701290110012C0009011E07410231012A075E0231013007A00009011E076A023900B40159003901B4014400410164078D022E003300C3022E0083002A032E000B00A7022E001300BD022E001B00BD022E002300BD022E002B00A7022E003B00BD022E004B00DB022E005300E1022E0063000B032E006B00BD022E00730018032E007B0021034300930063016000A300BB01A000DB00DD01B001B401C601D001FC0108021B02230227022B0235023A0247024E0253025802630270027A027F0292029A02020001000000BA0148000000C1014C000000C60151000000CB0155000000D50151000000DB0155000000E70151000000EC0151000000F701510000000302510002000100030002000200050002000900070001000A00070002000B00090001000D000B0002000C000B0002000E000D00010010000F0002000F000F0002001100110002001200130002001300150004800000010000000000000001000000BB002D000000020000000000000000000000010046000000000002000000000000000000000001005D000000000000000000003C4D6F64756C653E00457468696F7069616E44617465434C522E646C6C00457468696F7069616E4461746500457468696F7069616E44617465434C520045746844617465006D73636F726C69620053797374656D004F626A6563740053797374656D2E446174610053797374656D2E446174612E53716C547970657300494E756C6C61626C650049436F6D70617261626C650069735F4E756C6C005F59656172005F4D6F6E7468005F44617465006765745F49734E756C6C006765745F4E756C6C0053716C4461746554696D6500436F6E7665727446726F6D00546F4575726F7069616E446174650053716C537472696E670050617273650056616C6964617465457468696F7069616E4461746500546F537472696E6700546F4C6F6E67537472696E67006765745F44617465007365745F44617465006765745F446179537472696E67006765745F4D6F6E7468007365745F4D6F6E7468006765745F4D6F6E7468537472696E67006765745F59656172007365745F59656172006765745F46697363616C59656172006765745F46697363616C4D6F6E7468006765745F46697363616C4461746500436F6D70617265546F002E63746F720049734E756C6C004E756C6C004461746500446179537472696E67004D6F6E7468004D6F6E7468537472696E6700596561720046697363616C596561720046697363616C4D6F6E74680046697363616C446174650044617900546F44617465537472696E670053657444617465004765744D6F6E74684E616D65004765744461794E616D6500476574457468696F7069616E44617900476574457468696F7069616E5965617200436865636B4C6561705965617200457468696F7069616E546F4669786564004669786564546F457468696F7069616E004461794F665765656B00457468696F7069616E4461794F665765656B00477265676F7269616E546F466978656400477265676F7269616E546F457468696F7069616E004461746554696D65004765744461794F665765656B004765744461794F665765656B496E7400457468696F7069616E546F477265676F7269616E004669786564546F477265676F7269616E00477265676F7269616E5965617246726F6D4669786564006474007374720076616C7565006F626A0079656172006D6F6E7468006461790064644D4D7979797900677265676F7269616E5965617200677265676F7269616E4D6F6E746800677265676F7269616E44617900657468696F7069616E5965617200657468696F7069616E4D6F6E746800657468696F7069616E4461790066697865644461746500677265676F7269616E4461746500686F757200657468696F7069616E4461746544444D4D595959590053797374656D2E5265666C656374696F6E00417373656D626C795469746C6541747472696275746500417373656D626C794465736372697074696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C79436F6D70616E7941747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C7954726164656D61726B41747472696275746500417373656D626C7943756C747572654174747269627574650053797374656D2E52756E74696D652E496E7465726F70536572766963657300436F6D56697369626C65417474726962757465004775696441747472696275746500417373656D626C7956657273696F6E41747472696275746500417373656D626C7946696C6556657273696F6E4174747269627574650053797374656D2E5265736F7572636573004E65757472616C5265736F75726365734C616E67756167654174747269627574650053797374656D2E446961676E6F73746963730044656275676761626C6541747472696275746500446562756767696E674D6F6465730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650053657269616C697A61626C65417474726962757465004D6963726F736F66742E53716C5365727665722E5365727665720053716C55736572446566696E65645479706541747472696275746500466F726D6174005374727563744C61796F7574417474726962757465004C61796F75744B696E640053716C46756E6374696F6E417474726962757465006F705F496D706C696369740053716C4D6574686F64417474726962757465004368617200537472696E670053706C697400436F6E7665727400546F496E74333200417267756D656E74457863657074696F6E0053797374656D2E5465787400537472696E674275696C64657200417070656E64006765745F4E6F77006765745F44617900496E74333200436F6E636174004D61746800466C6F6F72004162730053797374656D2E476C6F62616C697A6174696F6E00477265676F7269616E43616C656E6461720043616C656E6461720049734C6561705965617200000080A549006E00760061006C0069006400200045007400680069006F007000690061006E00200044006100740065002C00200050006C0065006100730065002000700072006F00760069006400650020006100200063006F007200720065006300740020006E0075006D00620065007200200069006E002000740068006500200066006F0072006D006100740020002700640064002F006D006D002F007900790079007900270001094E0075006C006C0000032F00000720002D002000010720002C002000000B18123512A81228121D120109251345121D12751201070512F3122D1201097312051233123512010525132D120109E812AB1272127512010918120B136212751201091A12EB12DA12EB1201090D13951266127512010530129412010910121D1208120C1201079012031234120107331309131C12010530129E1201091B12AD1230129E12010728126112D51201070312191235120107A0122D12651201074512F3121C120107A5120112F5120101000000180C50BF13D53E4FA177469DC7AED3A00008B77A5C561934E089020602020608032000020400001208060001120811110420001111060001120811150320000E032000080420010108052001081208042001081C03200001032800020408001208032800080328000E06200301080808042001010E0400010E08060003080808080500020808080500020208080A000401081008100810080720031119080808090003011008100810080500010E111D04000108080420001119050001111D0E042001010205200101115980A0002400000480000094000000060200000024000052534131000400000100010021048FACB6D3662AB97A10CAB3A9851AD10965A9F723D8E762E870A9FA9D04C19F54E28653B611102C9034D5DFD713A8578E66A136A8DD8957BCB405E3F9113B4C87C2208749E15447C76A23D995B6C56B6CD7C24CE32DD727D13CC65B9751AA2B0A19E869FC6ED05049B44EEC35095CFDC09E8D28832F70BFFBBB534AAD4AA605200101116D46010001000000020054020D4973427974654F72646572656401540E1456616C69646174696F6E4D6574686F644E616D651556616C6964617465457468696F7069616E446174650520010111750307010206070212081208040100000005000111150E050702120802030611110C0707120C0808081111111102120100010054020A4F6E4E756C6C43616C6C000620011D0E1D03040001080E0B070512081D0E12081D03020407020202062001128091080620011280910E0707031280910E02030701080307010E0407020802040000111D040701111D0607021D0E1D030500010E1D0E0607030E0E1D0E0407020E0804070208080507030802020400010D0D060703081119080500010E1D1C0907060808080E021D1C04070111190D07071D0E080808111D111D1D03042001020807070312809D08080C070A0808080808080808080815010010457468696F7069616E44617465434C52000005010000000017010012436F7079726967687420C2A920203230313100000501000100002901002431343933333361612D376135312D343963372D383662392D35646663633537376238343700000C010007312E302E302E3000000801000701000000000801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F77730100000000000000B77A584D00000000020000008B000000D4420000D424000052534453106D24ED59CF3C41A6BDDE1304A60BF601000000633A5C75736572735C656C6961735C646F63756D656E74735C76697375616C2073747564696F20323031305C50726F6A656374735C457468696F7069616E446174655C457468696F7069616E44617465434C525C6F626A5C44656275675C457468696F7069616E44617465434C522E70646200008843000000000000000000009E430000002000000000000000000000000000000000000000000000904300000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF25002040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058600000F00200000000000000000000F00234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B00450020000010053007400720069006E006700460069006C00650049006E0066006F0000002C02000001003000300030003000300034006200300000004C0011000100460069006C0065004400650073006300720069007000740069006F006E000000000045007400680069006F007000690061006E00440061007400650043004C00520000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000004C001500010049006E007400650072006E0061006C004E0061006D006500000045007400680069006F007000690061006E00440061007400650043004C0052002E0064006C006C00000000004800120001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020002000320030003100310000005400150001004F0072006900670069006E0061006C00460069006C0065006E0061006D006500000045007400680069006F007000690061006E00440061007400650043004C0052002E0064006C006C0000000000440011000100500072006F0064007500630074004E0061006D0065000000000045007400680069006F007000690061006E00440061007400650043004C00520000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000C000000B03300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
WITH PERMISSION_SET = SAFE
GO

CREATE TYPE EthiopianDate
EXTERNAL NAME EthiopianDateCLR.[EthiopianDateCLR.EthiopianDate]
GO


CREATE Function ToEthiopianDate (@dt DateTime)
RETURNS EthiopianDate
External NAME [EthiopianDateCLR].[EthiopianDateCLR.EthiopianDate].[ConvertFrom]
GO